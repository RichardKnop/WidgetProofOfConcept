<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>
    <body>
        <script type="text/javascript">//<![CDATA[
            (function(w) {
                //------------------------------------
                // Widget Manager
                //------------------------------------
                function WidgetManager(placementId) {
                    this.placementId = placementId;
                    var adapterFactory = new AdapterFactory();
                    this.playerManager = new PlayerManager(adapterFactory.manufacture());
                }
                WidgetManager.prototype.loadConfig = function() {
                    console.log("load config based on " + this.placementId);
                }
                WidgetManager.prototype.loadModules = function(modules) {
                    console.log("loading modules " + modules.join(", "));
                }
                WidgetManager.prototype.loadVideo = function(id) {
                    this.playerManager.adapter.loadVideo(id);
                }

                //------------------------------------
                // Player Manager
                //------------------------------------
                function PlayerManager(adapter) {
                    this.adapter = adapter;
                }
                
                // Abstract adapter class
                function PlayerAdapter(config) {
                    this.config = config;
                }
                PlayerAdapter.prototype.loadVideo = function(id) {
                    console.log("loading video " + id);
                }
                
                // HTML5 adapter
                function HTML5Adapter(config) {
                    // call parent constructor
                    PlayerAdapter.call(this, config);
                }
                // inherit all parent methods
                HTML5Adapter.prototype = new PlayerAdapter();

                // Flash adapter
                function FlashAdapter(config) {
                    // call parent constructor
                    PlayerAdapter.call(this, config);
                }
                // inherit all parent methods
                FlashAdapter.prototype = new PlayerAdapter();

                // Adapter factory, will contain some logic to choose correct
                // adapter based on device, browser etc
                function AdapterFactory() {
                }
                AdapterFactory.prototype.manufacture = function() {
                    // some logic here
                    return new FlashAdapter({"foo": "bar"});
                }

                //------------------------------------
                // Assign objects we want visible outside current scope
                //------------------------------------
                w.WidgetManager = WidgetManager;
                w.PlayerManager = PlayerManager;
                w.AdapterFactory = AdapterFactory;
            })(window);

            // Let's go!
            var widgetManager = new WidgetManager("somePlacementId");
            widgetManager.loadConfig();
            widgetManager.loadModules(["module1", "module2", "module3"]);
            widgetManager.loadVideo("someVideoId");
            //]]></script>
    </body>
</html>